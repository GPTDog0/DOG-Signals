<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>üê∂ DOG SIGNALS</title>
<style>
body { font-family: "Inter", sans-serif; background: radial-gradient(circle at top, #1a0000 0%, #000 90%); color:#fff; text-align:center; margin:0; padding:0; overflow-y:auto;}
.header {background: linear-gradient(180deg, #220000, transparent); padding: 18px 0 10px; text-align:center; box-shadow:0 0 25px #ff000020;}
.header h1 {color:#ff3b3b; font-size:26px; font-weight:700; margin:0; text-shadow:0 0 20px #ff000099;}
button {border:none; border-radius:10px; font-size:16px; font-weight:500; padding:12px 0; width:160px; color:#fff; background: linear-gradient(180deg,#ff3b3b,#b30000); box-shadow:0 0 10px #ff000040; transition:.25s; cursor:pointer;}
button:hover{ transform:scale(1.05); box-shadow:0 0 18px #ff000060;}
button:disabled{ opacity:.5; background:#330000; cursor:not-allowed;}
.controls{ display:flex; justify-content:center; gap:12px; margin:12px auto 18px; flex-wrap:wrap;}
select{ background:#1a0000; border:1px solid #330000; border-radius:8px; color:#ffcccc; padding:8px 12px; font-size:15px;}
#tv_chart_container{ width:94%; max-width:420px; height:320px; margin:10px auto 30px; border-radius:10px; background:#080000; border:1px solid #330000; box-shadow:0 0 25px #ff000015; overflow:hidden; position:relative; padding-bottom:20px;}
#tv_chart_container.fullscreen{ position:fixed; inset:0; z-index:1000; width:100%; height:100%; max-width:none; border-radius:0; background:#000; padding:0;}
#tv_chart_container.fullscreen::after{ content:"‚úñ"; position:absolute; top:12px; right:16px; font-size:28px; color:#fff; cursor:pointer; z-index:1001;}
#expandChartBtn{ display:block; margin:-20px auto 30px; background:#222; border:1px solid #444; width:180px; font-size:15px;}
#signalDisplay, #otcSignalDisplay { font-size:18px; margin:15px 0; text-shadow:0 0 8px #ff000040; min-height:80px;}
@keyframes blinkUp{0%,100%{color:#4ade80; text-shadow:0 0 15px #22ff22;}50%{color:#fff; text-shadow:0 0 5px #fff;}}
@keyframes blinkDown{0%,100%{color:#ef4444; text-shadow:0 0 15px #ff2222;}50%{color:#fff; text-shadow:0 0 5px #fff;}}
.timer{ animation: blinkUp 1s infinite; }
#authBlock{ margin-top:80px; }
#authBlock input{ padding:8px 12px; border-radius:8px; border:1px solid #330000; background:#1a0000; color:#ffcccc; }
.activeTab { background: linear-gradient(180deg,#ff6666,#cc0000)!important; }
.small{ width:120px; }
</style>
</head>
<body>
<div class="header"><h1>üê∂ DOG SIGNALS</h1></div>

<!-- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è -->
<div id="authBlock">
  <p>–í–≤–µ–¥—ñ—Ç—å –≤–∞—à –∫–ª—é—á –¥–æ—Å—Ç—É–ø—É:</p>
  <input type="text" id="accessKey" placeholder="–í–≤–µ–¥—ñ—Ç—å –∫–ª—é—á...">
  <button id="checkKeyBtn">‚úÖ –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏</button>
  <p id="authMessage" style="color:#ff4444;margin-top:10px;"></p>
</div>

<!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
<div id="signals" style="display:none;">
  <div class="controls">
    <button id="classicBtn" class="activeTab">üí± –ó–≤–∏—á–∞–π–Ω–∏–π —Ä–∏–Ω–æ–∫</button>
    <button id="otcBtn">üìä OTC-—Ä–∏–Ω–æ–∫</button>
  </div>

  <!-- –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π —Ä—ã–Ω–æ–∫ -->
  <div id="classicMarket">
    <div class="controls">
      <select id="pairSelect">
        <option>EUR/USD</option><option>GBP/USD</option><option>USD/JPY</option>
        <option>USD/CHF</option><option>AUD/USD</option><option>NZD/USD</option>
        <option>EUR/JPY</option><option>GBP/JPY</option><option>EUR/GBP</option>
        <option>CAD/JPY</option><option>AUD/JPY</option><option>GBP/AUD</option><option>USD/CAD</option>
      </select>
      <select id="tfSelect">
        <option value="1m">1M</option><option value="3m">3M</option>
        <option value="5m">5M</option><option value="7m">7M</option>
      </select>
    </div>
    <div class="controls">
      <button id="getSignalBtn">üî• –û—Ç—Ä–∏–º–∞—Ç–∏ —Å–∏–≥–Ω–∞–ª</button>
      <button id="resetSignalBtn" disabled>–°–∫–∏–Ω—É—Ç–∏ —Å–∏–≥–Ω–∞–ª</button>
    </div>
    <div id="signalDisplay"></div>
    <div id="tv_chart_container"></div>
    <button id="expandChartBtn">üìà –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –≥—Ä–∞—Ñ–∏–∫</button>
  </div>

  <!-- OTC —Ä—ã–Ω–æ–∫ -->
  <div id="otcMarket" style="display:none;">
    <div class="controls">
      <select id="otcPairSelect">
        <option>EUR/USD OTC</option><option>GBP/USD OTC</option>
        <option>USD/JPY OTC</option><option>EUR/JPY OTC</option>
        <option>AUD/USD OTC</option><option>USD/CAD OTC</option>
      </select>

      <!-- –¢–∞–π–º—Ñ—Ä–µ–π–º –¥–ª—è OTC: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç –∏–ª–∏ Random -->
      <select id="otcTfSelect" class="small">
        <option value="random">üé≤ Random</option>
        <option value="5s">5—Å</option>
        <option value="10s">10—Å</option>
        <option value="30s">30—Å</option>
        <option value="1m">1–º</option>
        <option value="2m">2–º</option>
        <option value="3m">3–º</option>
        <option value="5m">5–º</option>
        <option value="10m">10–º</option>
      </select>
    </div>

    <div class="controls">
      <button id="getOtcSignalBtn">‚ö° –û—Ç—Ä–∏–º–∞—Ç–∏ —Å–∏–≥–Ω–∞–ª OTC</button>
      <button id="resetOtcSignalBtn" disabled>–°–∫–∏–Ω—É—Ç–∏</button>
    </div>

    <div id="otcSignalDisplay"></div>
  </div>
</div>

<script src="https://s3.tradingview.com/tv.js"></script>
<script>
// === –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è ===
const VALID_KEY = "DOG2025";
document.getElementById("checkKeyBtn").onclick = () => {
  const key = document.getElementById("accessKey").value.trim();
  const msg = document.getElementById("authMessage");
  if (key === VALID_KEY) {
    msg.style.color = "#4ade80";
    msg.textContent = "‚úÖ –î–æ—Å—Ç—É–ø –¥–æ–∑–≤–æ–ª–µ–Ω–æ!";
    document.getElementById("authBlock").style.display = "none";
    document.getElementById("signals").style.display = "block";
    localStorage.setItem("dogsignals_access", "granted");
  } else {
    msg.style.color = "#ef4444";
    msg.textContent = "‚ùå –ù–µ–≤—ñ—Ä–Ω–∏–π –∫–ª—é—á!";
  }
};
if (localStorage.getItem("dogsignals_access") === "granted") {
  document.getElementById("authBlock").style.display = "none";
  document.getElementById("signals").style.display = "block";
}

// === –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫ ===
const classic = document.getElementById('classicMarket');
const otc = document.getElementById('otcMarket');
const classicBtn = document.getElementById('classicBtn');
const otcBtn = document.getElementById('otcBtn');
classicBtn.onclick = () => { classic.style.display='block'; otc.style.display='none'; classicBtn.classList.add('activeTab'); otcBtn.classList.remove('activeTab'); };
otcBtn.onclick = () => { classic.style.display='none'; otc.style.display='block'; otcBtn.classList.add('activeTab'); classicBtn.classList.remove('activeTab'); };

// === –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π —Ä—ã–Ω–æ–∫ (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) ===
let timerInterval = null;
let activeSignal = null;
function tvSymbolFromPair(pair){ return `FX:${pair.replace('/','')}`; }
function tvIntervalFromTF(tf){ return {'1m':'1','3m':'3','5m':'5','7m':'7'}[tf]||'1'; }
function tfToSeconds(tf){ return parseInt(tf)*60; }
function loadTradingView(pair, tf){
  const c = document.getElementById("tv_chart_container"); c.innerHTML = '';
  try {
    new TradingView.widget({
      container_id: "tv_chart_container",
      symbol: tvSymbolFromPair(pair),
      interval: tvIntervalFromTF(tf),
      timezone: "Etc/UTC",
      theme: "dark",
      style: 1,
      locale: "ru",
      allow_symbol_change: false,
      hide_top_toolbar:true,
      hide_legend:true,
      enable_publishing:false,
      withdateranges:false
    });
  } catch(e){ c.innerHTML='‚ö†Ô∏è –ì—Ä–∞—Ñ–∏–∫ –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω'; }
}
function generateSignal(){ const dir = Math.random()>0.5?'UP':'DOWN'; const acc = (70+Math.random()*25).toFixed(1); return { direction: dir, accuracy: acc, remaining: 0 }; }
function updateSignalDisplay(){
  const d = document.getElementById("signalDisplay");
  if(!activeSignal) return;
  const m = Math.floor(activeSignal.remaining/60), s = activeSignal.remaining%60;
  const anim = activeSignal.direction==='UP'?'blinkUp':'blinkDown';
  d.innerHTML = `<div style="font-size:22px;font-weight:600;animation:${anim} 1s infinite;">${activeSignal.direction==='UP'?'üìà –í–≤–µ—Ä—Ö ‚Üë':'üìâ –í–Ω–∏–∑ ‚Üì'}</div>
                 <div>–¢–æ—á–Ω—ñ—Å—Ç—å: ${activeSignal.accuracy}%</div>
                 <div class="timer">–¢–∞–π–º–µ—Ä: ${m}:${s<10?'0'+s:s}</div>`;
}
document.getElementById("getSignalBtn").onclick = () => {
  const p = document.getElementById("pairSelect").value;
  const tf = document.getElementById("tfSelect").value;
  activeSignal = generateSignal();
  activeSignal.remaining = tfToSeconds(tf);
  document.getElementById("getSignalBtn").disabled = true;
  document.getElementById("resetSignalBtn").disabled = false;
  loadTradingView(p, tf);
  updateSignalDisplay();
  timerInterval = setInterval(()=>{ if(activeSignal.remaining>0){ activeSignal.remaining--; updateSignalDisplay(); } else { clearInterval(timerInterval); const r = Math.random()>0.5?'+':'-'; document.getElementById("signalDisplay").innerHTML = `<div>–ü–∞—Ä–∞: ${p} ¬∑ TF: ${tf}</div><div>–°–∏–≥–Ω–∞–ª: ${activeSignal.direction==='UP'?'üìà –í–≤–µ—Ä—Ö ‚Üë':'üìâ –í–Ω–∏–∑ ‚Üì'}</div><div>–¢–æ—á–Ω—ñ—Å—Ç—å: ${activeSignal.accuracy}%</div><div>${r==='+'?'<span style="color:#4ade80">‚úÖ +</span>':'<span style="color:#ef4444">‚ùå ‚àí</span>'}</div>`; } }, 1000);
};
document.getElementById("resetSignalBtn").onclick = () => { clearInterval(timerInterval); activeSignal = null; document.getElementById("signalDisplay").innerHTML=''; document.getElementById("tv_chart_container").innerHTML=''; document.getElementById("getSignalBtn").disabled=false; document.getElementById("resetSignalBtn").disabled=true; };

// === OTC —Ä—ã–Ω–æ–∫ (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: –¥–æ–±–∞–≤–ª–µ–Ω –≤—ã–±–æ—Ä —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞) ===
let otcTimer = null;
let activeOtc = null;

function parseTfToSeconds(tf){
  // tf like '5s','10s','30s','1m','2m', '10m' or 'random'
  if(!tf || tf === 'random') return null;
  if(tf.endsWith('s')) return parseInt(tf);
  if(tf.endsWith('m')) return parseInt(tf) * 60;
  return null;
}

function humanTf(tfSeconds){
  if(tfSeconds < 60) return `${tfSeconds}—Å`;
  return `${Math.floor(tfSeconds/60)}–º`;
}

function generateOtcSignalWithTf(selectedTf){
  // selectedTf –º–æ–∂–µ—Ç –±—ã—Ç—å 'random' –∏–ª–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π (–Ω–∞–ø—Ä–∏–º–µ—Ä '30s' –∏–ª–∏ '3m')
  let tfSeconds;
  if(selectedTf === 'random'){
    tfSeconds = Math.floor(Math.random() * (600 - 5 + 1)) + 5; // 5..600 sec
  } else {
    const parsed = parseTfToSeconds(selectedTf);
    tfSeconds = parsed !== null ? parsed : (Math.floor(Math.random() * (600 - 5 + 1)) + 5);
  }
  const dir = Math.random() > 0.5 ? 'UP' : 'DOWN';
  const acc = (70 + Math.random() * 25).toFixed(1);
  return { direction: dir, accuracy: acc, remaining: tfSeconds, tfSeconds: tfSeconds };
}

function updateOtcDisplay(){
  const d = document.getElementById('otcSignalDisplay');
  if(!activeOtc) return;
  const m = Math.floor(activeOtc.remaining/60);
  const s = activeOtc.remaining%60;
  const anim = activeOtc.direction==='UP'?'blinkUp':'blinkDown';
  d.innerHTML = `<div style="font-size:22px;font-weight:600;animation:${anim} 1s infinite;">${activeOtc.direction==='UP'?'üìà –í–≤–µ—Ä—Ö ‚Üë':'üìâ –í–Ω–∏–∑ ‚Üì'}</div>
                 <div>–¢–æ—á–Ω—ñ—Å—Ç—å: ${activeOtc.accuracy}%</div>
                 <div>TF: ${humanTf(activeOtc.tfSeconds)}</div>
                 <div class="timer">–¢–∞–π–º–µ—Ä: ${m}:${s<10?'0'+s:s}</div>`;
}

document.getElementById('getOtcSignalBtn').onclick = () => {
  const pair = document.getElementById('otcPairSelect').value;
  const selectedTf = document.getElementById('otcTfSelect').value; // 'random' or '5s','1m',...
  activeOtc = generateOtcSignalWithTf(selectedTf);

  document.getElementById('getOtcSignalBtn').disabled = true;
  document.getElementById('resetOtcSignalBtn').disabled = false;
  updateOtcDisplay();

  otcTimer = setInterval(()=>{
    if(activeOtc.remaining > 0){
      activeOtc.remaining--;
      updateOtcDisplay();
    } else {
      clearInterval(otcTimer);
      const r = Math.random() > 0.5 ? '+' : '-';
      document.getElementById('otcSignalDisplay').innerHTML = `<div>–ü–∞—Ä–∞: ${pair}</div>
        <div>–°–∏–≥–Ω–∞–ª: ${activeOtc.direction==='UP'?'üìà –í–≤–µ—Ä—Ö ‚Üë':'üìâ –í–Ω–∏–∑ ‚Üì'}</div>
        <div>TF: ${humanTf(activeOtc.tfSeconds)}</div>
        <div>–¢–æ—á–Ω—ñ—Å—Ç—å: ${activeOtc.accuracy}%</div>
        <div>${r==='+'?'<span style="color:#4ade80">‚úÖ +</span>':'<span style="color:#ef4444">‚ùå ‚àí</span>'}</div>`;
    }
  }, 1000);
};

document.getElementById('resetOtcSignalBtn').onclick = () => {
  clearInterval(otcTimer);
  activeOtc = null;
  document.getElementById('otcSignalDisplay').innerHTML = '';
  document.getElementById('getOtcSignalBtn').disabled = false;
  document.getElementById('resetOtcSignalBtn').disabled = true;
};
</script>
</body>
</html>

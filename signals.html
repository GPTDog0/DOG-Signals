<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DOG Signals | Pocket Option</title>
<style>
  body {
    font-family: "Inter", sans-serif;
    background: radial-gradient(circle at center, #0a0f1a 0%, #000 100%);
    color: #e2e8f0;
    text-align: center;
    margin: 0;
    padding: 0;
  }

  h1 {
    color: #22d3ee;
    font-weight: 700;
    font-size: 22px;
    margin: 20px 0;
  }

  .container {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 12px;
    margin-top: 10px;
  }

  select, button {
    background: #1e293b;
    border: 1px solid #334155;
    color: #e2e8f0;
    padding: 10px;
    border-radius: 10px;
    font-size: 15px;
    width: 220px;
    transition: all 0.3s ease;
  }

  select:disabled, button:disabled {
    opacity: 0.6;
    cursor: not-allowed;
  }

  button:hover {
    background: #22d3ee;
    color: #000;
  }

  #tv_chart_container {
    width: 95%;
    max-width: 360px;
    height: 280px;
    margin: 15px auto;
    border-radius: 10px;
    overflow: hidden;
    box-shadow: 0 0 20px rgba(45, 212, 191, 0.2);
    display: none;
  }

  #signalDisplay {
    margin-top: 10px;
    min-height: 80px;
  }

  .signal-line {
    font-size: 15px;
    margin: 4px 0;
  }

  .result-plus { color: #4ade80; font-weight: 700; }
  .result-minus { color: #ef4444; font-weight: 700; }
  .result-ret { color: #eab308; font-weight: 700; }
</style>
<script src="https://s3.tradingview.com/tv.js"></script>
</head>
<body>

<h1>üê∂ DOG Signals</h1>
<div class="container">
  <select id="pairSelect">
    <option>EUR/USD</option>
    <option>GBP/USD</option>
    <option>USD/JPY</option>
    <option>USD/CHF</option>
    <option>AUD/USD</option>
    <option>NZD/USD</option>
    <option>EUR/JPY</option>
    <option>GBP/JPY</option>
    <option>EUR/GBP</option>
  </select>

  <select id="tfSelect">
    <option value="1m">1M</option>
    <option value="3m">3M</option>
    <option value="5m">5M</option>
  </select>

  <button id="getSignalBtn">–û—Ç—Ä–∏–º–∞—Ç–∏ —Å–∏–≥–Ω–∞–ª</button>
  <button id="resetSignalBtn" disabled>–°–∫–∏–Ω—É—Ç–∏ —Å–∏–≥–Ω–∞–ª</button>
</div>

<div id="signalDisplay"></div>
<div id="tv_chart_container"></div>

<script>
let timerInterval = null;
let tvWidget = null;
let currentSignal = null;

// –¥–æ–ø–æ–º—ñ–∂–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è: –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π —Å–∏–º–≤–æ–ª –¥–ª—è TradingView
function tvSymbolFromPair(pair) {
  const clean = pair.replace('/', '').toUpperCase();
  return `FX:${clean}`;
}

// –¥–æ–ø–æ–º—ñ–∂–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è: —Ç–∞–π–º—Ñ—Ä–µ–π–º –¥–ª—è TradingView
function tvIntervalFromTF(tf) {
  const map = { '1m':'1', '3m':'3', '5m':'5', '1':'1','3':'3','5':'5' };
  return map[tf] || '1';
}

// –ø–æ–∫–∞–∑—É—î –∞–Ω—ñ–º–∞—Ü—ñ—é —Å–≤—ñ—á–æ–∫
function showCandleLoader(){
  signalDisplay.innerHTML = `
    <div style="display:flex;flex-direction:column;align-items:center;gap:8px;padding:15px 0">
      <svg width="120" height="60" viewBox="0 0 120 60" xmlns="http://www.w3.org/2000/svg">
        <g fill="none" stroke="#2dd4bf" stroke-width="1.5">
          <rect x="6" y="20" width="10" height="20" fill="#0f1724">
            <animate attributeName="y" values="20;15;20" dur="0.8s" repeatCount="indefinite"/>
          </rect>
          <rect x="26" y="10" width="10" height="30" fill="#059669">
            <animate attributeName="y" values="10;12;10" dur="0.8s" repeatCount="indefinite"/>
          </rect>
          <rect x="46" y="18" width="10" height="22" fill="#ef4444">
            <animate attributeName="y" values="18;14;18" dur="0.8s" repeatCount="indefinite"/>
          </rect>
          <rect x="66" y="6" width="10" height="34" fill="#059669">
            <animate attributeName="y" values="6;10;6" dur="0.8s" repeatCount="indefinite"/>
          </rect>
          <rect x="86" y="14" width="10" height="26" fill="#ef4444">
            <animate attributeName="y" values="14;16;14" dur="0.8s" repeatCount="indefinite"/>
          </rect>
        </g>
      </svg>
      <div style="color:#cfeefd;font-size:14px">–ì–µ–Ω–µ—Ä–∞—Ü—ñ—è —Å–∏–≥–Ω–∞–ª—É‚Ä¶</div>
    </div>
  `;
}

// –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è TradingView –≥—Ä–∞—Ñ—ñ–∫–∞
function loadTradingView(pair, tf) {
  const symbol = tvSymbolFromPair(pair);
  const interval = tvIntervalFromTF(tf);
  const chartContainer = document.getElementById("tv_chart_container");
  chartContainer.style.display = 'block';
  chartContainer.innerHTML = '';

  try {
    tvWidget = new TradingView.widget({
      container_id: "tv_chart_container",
      symbol: symbol,
      interval: interval,
      timezone: "Etc/UTC",
      theme: "dark",
      style: "1",
      locale: "ru",
      allow_symbol_change: false,
      withdateranges: false,
      hide_side_toolbar: true
    });

    setTimeout(()=>{
      if (chartContainer.innerHTML.trim() === '') {
        chartContainer.innerHTML = '<div style="padding:12px;color:#ffcccc">–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≥—Ä–∞—Ñ—ñ–∫–∞. –°–ø—Ä–æ–±—É–π—Ç–µ —ñ–Ω—à—É –ø–∞—Ä—É.</div>';
      }
    }, 6000);

  } catch(err) {
    chartContainer.innerHTML = `<div style="padding:12px;color:#ffcccc">–ü–æ–º–∏–ª–∫–∞: ${err.message}</div>`;
    console.error(err);
  }
}

// —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –≤–∏–ø–∞–¥–∫–æ–≤–æ–≥–æ —Å–∏–≥–Ω–∞–ª—É
function getRandomSignal() {
  const entries = ["UP ‚Üë", "DOWN ‚Üì"];
  const entry = entries[Math.floor(Math.random() * entries.length)];
  const duration = 60; // 60 —Å–µ–∫—É–Ω–¥
  return { entry, duration };
}

// –∫–Ω–æ–ø–∫–∞ –æ—Ç—Ä–∏–º–∞—Ç–∏ —Å–∏–≥–Ω–∞–ª
document.getElementById("getSignalBtn").onclick = () => {
  const signal = getRandomSignal();
  const pair = document.getElementById("pairSelect").value;
  const tf = document.getElementById("tfSelect").value;
  const getSignalBtn = document.getElementById("getSignalBtn");
  const resetBtn = document.getElementById("resetSignalBtn");

  getSignalBtn.disabled = true;
  document.getElementById("pairSelect").disabled = true;
  document.getElementById("tfSelect").disabled = true;
  resetBtn.disabled = true;

  showCandleLoader();
  document.getElementById("tv_chart_container").style.display = 'none';

  setTimeout(()=>{
    startSignal(signal);
    resetBtn.disabled = false;
  }, 1200);
};

function startSignal(signal){
  const pair = document.getElementById("pairSelect").value;
  const tf = document.getElementById("tfSelect").value;
  const signalDisplay = document.getElementById("signalDisplay");

  const endTime = Date.now() + signal.duration * 1000;
  function tick(){
    const remaining = Math.max(0, Math.ceil((endTime - Date.now())/1000));
    if (remaining <= 0) {
      clearInterval(timerInterval);
      const results = ['+','-','‚Ü∫'];
      const r = results[Math.floor(Math.random()*results.length)];
      signalDisplay.innerHTML = `
        <div class="signal-line">–ü–∞—Ä–∞: ${pair} ¬∑ TF: ${tf}</div>
        <div class="signal-line entry">–¢–æ—á–∫–∞ –≤—Ö–æ–¥—É: ${signal.entry}</div>
        <div class="signal-line">
          ${r === '+' ? '<span class="result-plus">+ (–ø—Ä–∏–±—É—Ç–æ–∫)</span>' : r === '-' ? '<span class="result-minus">‚àí (–∑–±–∏—Ç–æ–∫)</span>' : '<span class="result-ret">‚Ü∫ (–ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è)</span>'}
        </div>
      `;
    } else {
      signalDisplay.innerHTML = `
        <div class="signal-line">–ü–∞—Ä–∞: ${pair} ¬∑ TF: ${tf}</div>
        <div class="signal-line entry">–¢–æ—á–∫–∞ –≤—Ö–æ–¥—É: ${signal.entry}</div>
        <div class="signal-line tmr">–¢–∞–π–º–µ—Ä: 00:${remaining < 10 ? '0'+remaining : remaining}</div>
      `;
    }
  }

  tick();
  timerInterval = setInterval(tick, 1000);
  loadTradingView(pair, tf);
}

// —Å–∫–∏–¥–∞–Ω–Ω—è —Å–∏–≥–Ω–∞–ª—É
document.getElementById("resetSignalBtn").onclick = () => {
  clearInterval(timerInterval);
  document.getElementById("signalDisplay").innerHTML = '';
  document.getElementById("tv_chart_container").style.display = 'none';
  document.getElementById("getSignalBtn").disabled = false;
  document.getElementById("pairSelect").disabled = false;
  document.getElementById("tfSelect").disabled = false;
  document.getElementById("resetSignalBtn").disabled = true;
};
</script>
</body>
</html>
